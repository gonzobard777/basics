# Особенности работы с res-файлами

## Ресурсный файл по умолчанию

Допустим надо локализовать две строки:

- "Не найдено"
- "Некорректный запрос"

Это строки, которые можно использовать повсеместно, поэтому название для ресурсного файла будет "CommonResource".

Первым делом надо создать **ресурсный файл по умолчанию**, иногда его еще называют **основной файл ресурсов**.  
В нашем случае ресурсник по умолчанию будет для русского языка и создам его в папке `L10n`:  
![](./pic/res-default.png)

здесь:

- **CommonResource.resx** - xml файл ресурсника
- **CommonResource.Designer.cs** - создается автоматически. Экспортирует класс `CommonResource` - именно этот класс будем использовать в коде для доступа к локализации.

**Важно!** Ресурсник по умолчанию используется, если для текущей культуры dotnet не может найти ресурсник.  
Например, в программе предполагается использовать 4 языка: **ru** (по умолчанию), **en**, **de**, **es**.  
Ресурсники для языков - **en**, **de**, **es** - будут выбраны, только, если текущая культура совпадет с ними.  
А вот с ресурсник по умолчанию будет выбран для культуры **ru**, также он будет выбран для культуры **fr** или для вообще любой культуры, отличной от **en**, **de**, **es**.

**Важно!** Один раз выбрав для ресурсника по умолчанию, например, русский язык, тогда содержимое всех других ресурсников-по-умолчанию придется также наполнять русским переводом, потому что поменять на другой язык в ресурснике по умолчанию может оказаться трудоемким занятием.

# Локализованный файл ресурсов

При добавлении локализованных ресурсов:

1. Указывайте для них тоже имя файла, что и для ресурсного файла по умолчанию
2. Также в имени файла необходимо указать культуру

В нашем случае ресурсный файл по умолчанию `CommonResource.resx`, который содержит локализацию для русского языка.  
Допустим, я хочу добавить локализацию для английского языка, значит мне надо создать ресурсный файл с именем `CommonResource.en`:  
![](./pic/res-localized.png)

здесь:

- **CommonResource.resx** - xml файл ресурсника по умолчанию
- **CommonResource.Designer.cs** - создается автоматически. Экспортирует класс `CommonResource` - именно этот класс будем использовать в коде для доступа к локализации.
- **CommonResource.en.resx** - xml файл ресурсника с локализациями для культуры `en`

Итак, при текущей конфигурации, если культура совпадает с `en`, то локализации будут браться из ресурсника `CommonResource.en.resx`, для всех остальных культур локализации будут браться из ресурсника `CommonResource.resx`, а в нашем примере он содержит локализации для русского языка.

# Редакторы ресурсных файлов

## Rider

Наверное самый удобный редактор.  
Для его вызова надо в верхнем меню вызвать: **Tools** ➔ **Localization Manager**:  
![](./pic/res-localization-manager.png)

здесь:

- по кнопке 1 можно добавить Локализованный файл ресурсов
- по кнопке 2 можно редактировать локализованные строки. Причем будет гарантирован контроль, что во всех файлах ресурсов будет одинаковый состав и содержимое ключей

# Использование ресурса в другом проекте

1. В настройках ресурса по умолчанию (ПКМ-Properties), в поле **Custom tool** надо сменить значение с `ResXFileCodeGenerator` на `PublicResXFileCodeGenerator`.
2. Перегенерить ресурсник. В Rider это делается через меню по ПКМ, пункт **Generate resources**. Либо можно запустить проект, тогда dotnet сам все перегенерит.

Для рассматриваемого примера, после проделанных действий, класс `CommonResource`, который определен в файле `CommonResource.Designer.cs`, сменит модификатор с **internal** на **public**.
